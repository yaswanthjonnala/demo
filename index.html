<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple CRUD Frontend</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 30px;
        background-color: #f4f4f4;
      }
      h1 {
        color: #333;
      }
      form input {
        padding: 8px;
        margin-right: 10px;
      }
      button {
        padding: 8px 10px;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }
      li {
        background: #fff;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 6px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
    </style>
  </head>
  <body>
    <h1>Simple CRUD App</h1>
    <form id="addForm">
      <input type="text" id="itemName" placeholder="Enter item name" required />
      <button type="submit">Add Item</button>
    </form>
    <ul id="itemList"></ul>
    <script>
      const API_URL = "http://localhost:5000/items";
      const itemList = document.getElementById("itemList");
      const addForm = document.getElementById("addForm");
      const itemName = document.getElementById("itemName");
      // Load all items on page load
      window.onload = loadItems;
      function loadItems() {
        fetch(API_URL)
          .then((res) => res.json())
          .then((data) => {
            itemList.innerHTML = "";
            data.forEach((item) => {
              const li = document.createElement("li");

              // create safe DOM nodes instead of inline onclick (avoids quoting issues)
              const nameSpan = document.createElement("span");
              nameSpan.textContent = item.name;

              const actions = document.createElement("span");

              const editBtn = document.createElement("button");
              editBtn.textContent = "Edit";
              editBtn.addEventListener("click", () => editItem(item.id, item.name));

              const delBtn = document.createElement("button");
              delBtn.textContent = "Delete";
              delBtn.addEventListener("click", () => deleteItem(item.id));

              actions.appendChild(editBtn);
              actions.appendChild(delBtn);

              li.appendChild(nameSpan);
              li.appendChild(actions);
              itemList.appendChild(li);
            });
          });
      }
      addForm.addEventListener("submit", (e) => {
        e.preventDefault();
        fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name: itemName.value }),
        })
          .then((res) => res.json())
          .then(() => {
            itemName.value = "";
            loadItems();
          });
      });
      function deleteItem(id) {
        // use template literal with backticks
        fetch(`${API_URL}/${id}`, { method: "DELETE" }).then(() => loadItems());
      }
      function editItem(id, oldName) {
        const newName = prompt("Enter new name:", oldName);
        if (newName && newName !== oldName) {
          // use template literal with backticks
          fetch(`${API_URL}/${id}`, {
            method: "PATCH",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name: newName }),
          }).then(() => loadItems());
        }
      }
    </script>
  </body>
</html>